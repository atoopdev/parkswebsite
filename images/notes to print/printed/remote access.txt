Explore remote access (VPN)

Explore virtual private networks
A VPN provides a point-to-point connection between components of a private network, through a public network such as the Internet. Tunneling protocols enable a VPN client to establish and maintain a connection to the listening virtual port of a VPN server. To emulate a point-to-point link, the data is encapsulated, or wrapped, and prefixed with a header. This header provides routing information that enables the data to traverse the public network to reach its endpoint. To emulate a private link, the data is encrypted to ensure confidentiality. Packets that are intercepted on the public network are indecipherable without encryption keys.

two types of vpn connections:
remote access - enable users who are working at home, at customer sites, or from public wireless access points to access a server that exists in your organization’s private network. Appears to end user as seamless private link.
site to site (or router to router) - routed connections between separate offices or with other organizations over a public network, while maintaining secure communications.

Properties of VPN connections

VPN connections in Windows can use:

Point-to-Point Tunneling Protocol (PPTP)
Layer Two Tunneling Protocol with IPsec (L2TP/IPsec)
Secure Socket Tunneling Protocol (SSTP)
Internet Key Exchange version 2 (IKEv2) (has reconnect)

Common characteristics of all vpn connections -
encapsulation: private data is encapsulated with a header that contains routing information, which allows the data to traverse the transit network.
authentication: the two communicating parties know with whom they are communicating.
Data encryption: the sender encrypts the data and the receiver decrypts it. Uses common encryption key between both users.

Conditional Access Framework
You can integrate VPN with Azure Active Directory (Azure AD) Conditional Access Framework for additional security. Conditional Access Framework is an Azure AD policy engine that works with MDM solution like Intune to to verify device compliance before granting access. Conditional Access policies allow you to build conditions that manage security controls that can block access, require multi-factor authentication, or restrict the user’s session when needed and stay out of the user’s way when not.
Conditional Access policies at their simplest are if-then statements. If a user wants to access a resource, then they must complete an action. Example: A payroll manager wants to access the company's payroll application and is required to complete multi-factor authentication to access it.

User or group membership. Policies can be targeted to specific users and groups giving administrators fine-grained control over access.
IP Location information. Organizations can create trusted IP address ranges that can be used when making policy decisions. Administrators can specify entire countries/regions IP ranges to block or allow traffic from.
Device. Users with devices of specific platforms or marked with a specific state can be used when enforcing Conditional Access policies.
Application. Users attempting to access specific applications can trigger different Conditional Access policies.
Real-time and calculated risk detection. Signals integration with Azure AD Identity Protection allows Conditional Access policies to identify risky sign-in behavior. Policies can then force users to change their password, do multi-factor authentication to reduce their risk level, or block access until an administrator takes manual action.
Microsoft Defender for Cloud Apps. Enables user application access and sessions to be monitored and controlled in real time, increasing visibility and control over access to and activities done within your cloud environment.
Many organizations have common access concerns that Conditional Access policies can help with, such as:

Requiring multi-factor authentication for users with administrative roles.
Requiring multi-factor authentication for Azure management tasks.
Blocking sign-ins for users attempting to use legacy authentication protocols.
Requiring trusted locations for Azure AD Multi-Factor Authentication registration.
Blocking or granting access from specific locations.
Blocking risky sign-in behaviors.
Requiring organization-managed devices for specific applications.

Windows Information Protection
Windows Information Protection is a feature that uses a number of technologies (including BitLocker Drive Encryption, AppLocker, and Microsoft Azure Rights Management) to protect enterprise data against leakage and unauthorized use. It relies on Microsoft Intune, Microsoft Endpoint Configuration Manager, or another third-party MDM solution to create and deploy policies that you use to specify protected apps, and to apply desired protection levels to your data.

With the new VPNv2 configuration service provider, you have the ability to use an MDM solution to configure VPN profiles on managed devices.
- Always On. (automatic connection following user sign on or network change.)
- App triggered vpn. - certain apps trigger automatic connections. (available to workgroup and domain computers.)
-Traffic filters. With this feature, you can control the types of network traffic that will be able to reach your corporate network. app-based rules - list of allowed applications. traffic-based rules - source/destination ip, source/destination ports, network protocol.
-lockdown vpn - you can ensure that a user cannot modify the VPN profile or disconnect an active VPN connection. You also can implement forced tunneling and block outbound traffic if the VPN connection is not available.

Create a VPN connection in Windows client
Network>Network and Internet Settings. Click VPN. Add VPN.
In the Add a VPN connection dialog box, in the VPN provider list, tap Windows (built-in).
In the Connection name box, enter a meaningful name, such as Office Network.
In the Server name or address text box, type the FQDN of the server to which you want to connect. This is usually the name of the VPN server.
In the VPN type list, select between Point to Point Tunneling Protocol (PPTP), L2TP/IPsec with certificate, L2TP/IPSec with pre-shared key, Secure Socket Tunneling Protocol (SSTP), and IKEv2. This setting must match the setting and policies configured on your VPN server. If you are unsure, tap Automatic.
In the Type of sign-in info list, select either User name and password, Smart card, One-time password, or Certificate. Again, this setting must match your VPN server policies.
In the User name (optional) box, type your user name, and then in the Password (optional) box, type your password. Select the Remember my sign-in info check box, and then tap Save.

to edit, go to Network>Network and Internet Settings. Click VPN. click the vpn connection then advanced options.

Describe Always on VPN

problems with reg vpn
-users must initiate and they don't understand when is needed
-traditional vpns run all traffic through the vpn. Is inefficient and wastes bandwidth.

Always On - Administrators configure routing policies to determine when the client should direct traffic over the VPN.Policies can be based on user, hardware, or software criteria. Happens without user's involvement.

What is needed for Always On VPN -
Other than your Domain Controller and DNS servers, the Always On VPN deployment requires an NPS (RADIUS) server, a Certification Authority (CA) server, and a Remote Access (Routing/VPN) server. Once the infrastructure is set up, you must enroll clients and then connect the clients to your on-premises securely through several network changes.

Always On VPN and Direct Access
Always On is now considered superior to Direct Access.(Direct Access also provide seamless access, but required IPv6 and that clients be domain-joined.)  Always On VPN can use either IPv4 or IPv6, and supports non-domain joined devices.Always On VPN also provides more granular controls over how traffic is routed and support for conditional access policies. Always On VPN only supports Windows 10 and later clients, while Direct Access support Windows 8.1. 

Configuring Clients for Always On VPN
Windows 10 and later clients are configured for Always On VPN through ProfileXML. ProfileXML is a uniform resource identifier (URI) node within the VPNv2 configuration service provider (CSP). CSPs work similar to how Group Policy works.u configure CSP nodes by using a mobile device management (MDM) solution such as Microsoft Intune. In this case, configuring a specific node called ProfileXML in the VPNv2 CSP, which contains all the settings necessary.The settings and XML file are typically created by the Administrator responsible for the VPN infrastructure. Once the XML file is created, it can be deployed to clients with either a device profile in Intune or as a package in Configuration Manager. It can also be deployed using PowerShell.
